{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Elli0t/richard/lib/schema.ts"],"sourcesContent":["import { sqliteTable, text, integer, real } from 'drizzle-orm/sqlite-core';\r\nimport { relations } from 'drizzle-orm';\r\n\r\nexport const users = sqliteTable('users', {\r\n  id: integer('id').primaryKey({ autoIncrement: true }),\r\n  email: text('email').unique().notNull(),\r\n  passwordHash: text('password_hash').notNull(),\r\n  role: text('role').$defaultFn(() => 'user'), // user, admin\r\n  createdAt: integer('created_at').$defaultFn(() => Math.floor(Date.now() / 1000)),\r\n});\r\n\r\nexport const orders = sqliteTable('orders', {\r\n  id: integer('id').primaryKey({ autoIncrement: true }),\r\n  userId: integer('user_id').references(() => users.id),\r\n  email: text('email').notNull(),\r\n  discordUsername: text('discord_username'),\r\n  notes: text('notes'),\r\n  total: real('total').notNull(),\r\n  proofImage: text('proof_image'), // base64 encoded image\r\n  status: text('status').$defaultFn(() => 'pending'), // pending, processing, completed, cancelled\r\n  orderId: text('order_id').unique().notNull(),\r\n  createdAt: integer('created_at').$defaultFn(() => Math.floor(Date.now() / 1000)),\r\n});\r\n\r\nexport const orderItems = sqliteTable('order_items', {\r\n  id: integer('id').primaryKey({ autoIncrement: true }),\r\n  orderId: integer('order_id').references(() => orders.id).notNull(),\r\n  game: text('game').notNull(),\r\n  duration: text('duration').notNull(),\r\n  price: real('price').notNull(),\r\n});\r\n\r\n// Relations\r\nexport const usersRelations = relations(users, ({ many }) => ({\r\n  orders: many(orders),\r\n}));\r\n\r\nexport const ordersRelations = relations(orders, ({ one, many }) => ({\r\n  user: one(users, {\r\n    fields: [orders.userId],\r\n    references: [users.id],\r\n  }),\r\n  items: many(orderItems),\r\n}));\r\n\r\nexport const orderItemsRelations = relations(orderItems, ({ one }) => ({\r\n  order: one(orders, {\r\n    fields: [orderItems.orderId],\r\n    references: [orders.id],\r\n  }),\r\n}));"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA;;;AAEO,MAAM,QAAQ,IAAA,qRAAW,EAAC,SAAS;IACxC,IAAI,IAAA,8RAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,OAAO,IAAA,wRAAI,EAAC,SAAS,MAAM,GAAG,OAAO;IACrC,cAAc,IAAA,wRAAI,EAAC,iBAAiB,OAAO;IAC3C,MAAM,IAAA,wRAAI,EAAC,QAAQ,UAAU,CAAC,IAAM;IACpC,WAAW,IAAA,8RAAO,EAAC,cAAc,UAAU,CAAC,IAAM,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;AAC5E;AAEO,MAAM,SAAS,IAAA,qRAAW,EAAC,UAAU;IAC1C,IAAI,IAAA,8RAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,QAAQ,IAAA,8RAAO,EAAC,WAAW,UAAU,CAAC,IAAM,MAAM,EAAE;IACpD,OAAO,IAAA,wRAAI,EAAC,SAAS,OAAO;IAC5B,iBAAiB,IAAA,wRAAI,EAAC;IACtB,OAAO,IAAA,wRAAI,EAAC;IACZ,OAAO,IAAA,wRAAI,EAAC,SAAS,OAAO;IAC5B,YAAY,IAAA,wRAAI,EAAC;IACjB,QAAQ,IAAA,wRAAI,EAAC,UAAU,UAAU,CAAC,IAAM;IACxC,SAAS,IAAA,wRAAI,EAAC,YAAY,MAAM,GAAG,OAAO;IAC1C,WAAW,IAAA,8RAAO,EAAC,cAAc,UAAU,CAAC,IAAM,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;AAC5E;AAEO,MAAM,aAAa,IAAA,qRAAW,EAAC,eAAe;IACnD,IAAI,IAAA,8RAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,SAAS,IAAA,8RAAO,EAAC,YAAY,UAAU,CAAC,IAAM,OAAO,EAAE,EAAE,OAAO;IAChE,MAAM,IAAA,wRAAI,EAAC,QAAQ,OAAO;IAC1B,UAAU,IAAA,wRAAI,EAAC,YAAY,OAAO;IAClC,OAAO,IAAA,wRAAI,EAAC,SAAS,OAAO;AAC9B;AAGO,MAAM,iBAAiB,IAAA,qQAAS,EAAC,OAAO,CAAC,EAAE,IAAI,EAAE,GAAK,CAAC;QAC5D,QAAQ,KAAK;IACf,CAAC;AAEM,MAAM,kBAAkB,IAAA,qQAAS,EAAC,QAAQ,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,GAAK,CAAC;QACnE,MAAM,IAAI,OAAO;YACf,QAAQ;gBAAC,OAAO,MAAM;aAAC;YACvB,YAAY;gBAAC,MAAM,EAAE;aAAC;QACxB;QACA,OAAO,KAAK;IACd,CAAC;AAEM,MAAM,sBAAsB,IAAA,qQAAS,EAAC,YAAY,CAAC,EAAE,GAAG,EAAE,GAAK,CAAC;QACrE,OAAO,IAAI,QAAQ;YACjB,QAAQ;gBAAC,WAAW,OAAO;aAAC;YAC5B,YAAY;gBAAC,OAAO,EAAE;aAAC;QACzB;IACF,CAAC"}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Elli0t/richard/lib/db.ts"],"sourcesContent":["import { drizzle } from 'drizzle-orm/libsql';\r\nimport { createClient } from '@libsql/client';\r\nimport * as schema from './schema';\r\n\r\nconst client = createClient({\r\n  url: process.env.TURSO_DATABASE_URL!,\r\n  authToken: process.env.TURSO_AUTH_TOKEN,\r\n});\r\n\r\nexport const db = drizzle(client, { schema });"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,SAAS,IAAA,oJAAY,EAAC;IAC1B,KAAK,QAAQ,GAAG,CAAC,kBAAkB;IACnC,WAAW,QAAQ,GAAG,CAAC,gBAAgB;AACzC;AAEO,MAAM,KAAK,IAAA,0RAAO,EAAC,QAAQ;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Elli0t/richard/app/actions/orders.ts"],"sourcesContent":["'use server'\r\n\r\nimport { db } from '@/lib/db'\r\nimport { orders, orderItems } from '@/lib/schema'\r\nimport { eq, desc } from 'drizzle-orm'\r\nimport { cookies } from 'next/headers'\r\nimport { CartItem } from '@/lib/cart-store'\r\n\r\nexport async function saveOrder(formData: FormData) {\r\n  const email = formData.get('email') as string\r\n  const discordUsername = formData.get('discordUsername') as string\r\n  const notes = formData.get('notes') as string\r\n  const total = parseFloat(formData.get('total') as string)\r\n  const proofImage = formData.get('proofImage') as string\r\n  const itemsJson = formData.get('items') as string\r\n\r\n  if (!email || !proofImage || !itemsJson) {\r\n    return { error: 'Missing required fields' }\r\n  }\r\n\r\n  let items: CartItem[]\r\n  try {\r\n    items = JSON.parse(itemsJson)\r\n  } catch {\r\n    return { error: 'Invalid items data' }\r\n  }\r\n\r\n  if (items.length === 0) {\r\n    return { error: 'No items in order' }\r\n  }\r\n\r\n  try {\r\n    // Get user_id from cookie if logged in\r\n    const cookieStore = await cookies()\r\n    const userIdCookie = cookieStore.get('user_id')?.value\r\n    const userId = userIdCookie ? parseInt(userIdCookie) : null\r\n\r\n    // Generate order_id\r\n    const orderId = `FL-${Date.now()}`\r\n\r\n    // Insert order\r\n    const orderResult = await db.insert(orders).values({\r\n      userId,\r\n      email,\r\n      discordUsername,\r\n      notes,\r\n      total,\r\n      proofImage,\r\n      orderId,\r\n    }).returning({ id: orders.id })\r\n\r\n    const orderDbId = orderResult[0].id\r\n\r\n    // Insert order items\r\n    await db.insert(orderItems).values(\r\n      items.map(item => ({\r\n        orderId: orderDbId,\r\n        game: item.game,\r\n        duration: item.duration,\r\n        price: item.price,\r\n      }))\r\n    )\r\n\r\n    return { success: true, orderId }\r\n  } catch (error) {\r\n    console.error('Save order error:', error)\r\n    return { error: 'Failed to save order' }\r\n  }\r\n}\r\n\r\nexport async function getUserOrders() {\r\n  const cookieStore = await cookies()\r\n  const userId = cookieStore.get('user_id')?.value\r\n\r\n  if (!userId) {\r\n    return { error: 'Not authenticated' }\r\n  }\r\n\r\n  try {\r\n    // Get orders with items\r\n    const ordersWithItems = await db.query.orders.findMany({\r\n      where: eq(orders.userId, parseInt(userId)),\r\n      orderBy: [desc(orders.createdAt)],\r\n      with: {\r\n        items: true,\r\n      },\r\n    })\r\n\r\n    return { success: true, orders: ordersWithItems }\r\n  } catch (error) {\r\n    console.error('Get orders error:', error)\r\n    return { error: 'Failed to get orders' }\r\n  }\r\n}"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAAA;AACA;;;;;;;;;;;AAGO,eAAe,UAAU,QAAkB;IAChD,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,kBAAkB,SAAS,GAAG,CAAC;IACrC,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,QAAQ,WAAW,SAAS,GAAG,CAAC;IACtC,MAAM,aAAa,SAAS,GAAG,CAAC;IAChC,MAAM,YAAY,SAAS,GAAG,CAAC;IAE/B,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,WAAW;QACvC,OAAO;YAAE,OAAO;QAA0B;IAC5C;IAEA,IAAI;IACJ,IAAI;QACF,QAAQ,KAAK,KAAK,CAAC;IACrB,EAAE,OAAM;QACN,OAAO;YAAE,OAAO;QAAqB;IACvC;IAEA,IAAI,MAAM,MAAM,KAAK,GAAG;QACtB,OAAO;YAAE,OAAO;QAAoB;IACtC;IAEA,IAAI;QACF,uCAAuC;QACvC,MAAM,cAAc,MAAM,IAAA,oRAAO;QACjC,MAAM,eAAe,YAAY,GAAG,CAAC,YAAY;QACjD,MAAM,SAAS,eAAe,SAAS,gBAAgB;QAEvD,oBAAoB;QACpB,MAAM,UAAU,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI;QAElC,eAAe;QACf,MAAM,cAAc,MAAM,0HAAE,CAAC,MAAM,CAAC,kIAAM,EAAE,MAAM,CAAC;YACjD;YACA;YACA;YACA;YACA;YACA;YACA;QACF,GAAG,SAAS,CAAC;YAAE,IAAI,kIAAM,CAAC,EAAE;QAAC;QAE7B,MAAM,YAAY,WAAW,CAAC,EAAE,CAAC,EAAE;QAEnC,qBAAqB;QACrB,MAAM,0HAAE,CAAC,MAAM,CAAC,sIAAU,EAAE,MAAM,CAChC,MAAM,GAAG,CAAC,CAAA,OAAQ,CAAC;gBACjB,SAAS;gBACT,MAAM,KAAK,IAAI;gBACf,UAAU,KAAK,QAAQ;gBACvB,OAAO,KAAK,KAAK;YACnB,CAAC;QAGH,OAAO;YAAE,SAAS;YAAM;QAAQ;IAClC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO;YAAE,OAAO;QAAuB;IACzC;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,oRAAO;IACjC,MAAM,SAAS,YAAY,GAAG,CAAC,YAAY;IAE3C,IAAI,CAAC,QAAQ;QACX,OAAO;YAAE,OAAO;QAAoB;IACtC;IAEA,IAAI;QACF,wBAAwB;QACxB,MAAM,kBAAkB,MAAM,0HAAE,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC;YACrD,OAAO,IAAA,qRAAE,EAAC,kIAAM,CAAC,MAAM,EAAE,SAAS;YAClC,SAAS;gBAAC,IAAA,mRAAI,EAAC,kIAAM,CAAC,SAAS;aAAE;YACjC,MAAM;gBACJ,OAAO;YACT;QACF;QAEA,OAAO;YAAE,SAAS;YAAM,QAAQ;QAAgB;IAClD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO;YAAE,OAAO;QAAuB;IACzC;AACF;;;IArFsB;IA8DA;;AA9DA,yXAAA;AA8DA,yXAAA"}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Elli0t/richard/.next-internal/server/app/checkout/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {saveOrder as '40870bedd7b9e77a75e667575f1added96759c2a3b'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}